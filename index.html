<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINHMODLAG V50 - COMMAND CENTER</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00a884; --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; --border: #e4e6eb; --header: #ffffff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; }
        header { position: fixed; top:0; width:100%; height:75px; background: var(--header); display:flex; align-items:center; padding:0 25px; box-shadow:0 2px 15px rgba(0,0,0,0.1); z-index:1000; box-sizing:border-box; }
        .logo { font-weight:900; font-size: 26px; color:var(--accent); cursor: pointer; }
        .wallet { background:#1a1a1a; color:#00ff88; padding:8px 18px; border-radius:30px; font-weight:bold; margin-left:auto; border: 2px solid var(--accent); font-family: monospace; }
        .container { margin-top:100px; padding:20px; max-width:1100px; margin-inline:auto; }
        .intro-box { background: linear-gradient(135deg, #00a884 0%, #007d63 100%); color: white; padding: 25px; border-radius: 20px; margin-bottom: 25px; }
        .shop-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:20px; }
        .product-card { background: var(--card); padding:25px; border-radius:20px; border:1px solid var(--border); text-align:center; }
        .stock-info { font-size: 11px; background: #f9f9f9; padding: 10px; border-radius: 12px; text-align: left; margin-bottom: 10px; }
        input, select, button, textarea { width:100%; padding:13px; margin:8px 0; border-radius:10px; border:1px solid var(--border); box-sizing: border-box; outline: none; }
        .btn-buy { background:var(--accent); color:#fff; border:none; font-weight:bold; cursor:pointer; text-transform:uppercase; }
        #sideMenu { position:fixed; top:0; left:-450px; width:380px; height:100%; background: var(--card); z-index:2000; padding:25px; transition:0.4s; box-shadow:15px 0 40px rgba(0,0,0,0.3); overflow-y:auto; box-sizing:border-box; }
        .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:5000; align-items:center; justify-content:center; backdrop-filter: blur(5px); }
        .modal-content { background: var(--card); padding:30px; border-radius:25px; width:450px; border:2px solid var(--accent); }
        .hist-item { background: var(--bg); padding:12px; border-radius:12px; margin-bottom:10px; text-align: left; font-size: 13px; border-left: 5px solid var(--accent); }
        #robotLogs { background: #111; color: #0f8; padding: 10px; border-radius: 10px; font-family: monospace; font-size: 11px; height: 100px; overflow-y: auto; margin: 10px 0; border: 1px solid #333; }
        #authScreen { position: fixed; inset: 0; background: var(--accent); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .auth-box { background: var(--card); padding: 40px; border-radius: 25px; width: 350px; text-align: center; }
    </style>
</head>
<body>

    <div id="authScreen">
        <div class="auth-box">
            <h1 style="color:var(--accent); font-weight:900;">VINHMODLAG</h1>
            <input type="text" id="uLog" placeholder="T√™n ƒëƒÉng nh·∫≠p...">
            <input type="password" id="pLog" placeholder="M·∫≠t kh·∫©u...">
            <button class="btn-buy" onclick="doLogin()">V√ÄO C·ª¨A H√ÄNG</button>
            <p style="font-size:12px; color:#888; margin-top:10px;">Ch∆∞a c√≥ t√†i kho·∫£n? Li√™n h·ªá Zalo Admin</p>
        </div>
    </div>

    <div id="app" style="display:none">
        <header>
            <div onclick="openMenu()" style="font-size:25px; cursor:pointer; color: var(--accent);">‚ò∞</div>
            <div class="logo" style="margin-left:15px;">VINHMODLAG</div>
            <div class="wallet"><span id="uBal">0</span>ƒë</div>
        </header>

        <div id="sideMenu">
            <h2>üë§ S·∫øp: <span id="uNameDisp" style="color:var(--accent)"></span></h2>
            <button onclick="showHistory()" style="background:#333; color:white; font-size:12px;">üìä L·ªäCH S·ª¨ GIAO D·ªäCH</button>
            <hr style="border:0; border-top:1px solid var(--border); margin:15px 0;">

            <div id="adminPanel" style="display:none; background:#000; color:#0f8; padding:15px; border-radius:15px; margin-top:10px;">
                <b>üñ•Ô∏è ROBOT ADMIN</b>
                <div id="robotLogs">ƒêang ch·ªù l·ªánh s·∫øp...</div>
                <input id="robotCmd" placeholder="Nh·∫≠p l·ªánh Robot..." style="background:#111; color:#fff; border-color:#333;">
                <button onclick="executeRobot()" style="background:#0f8; color:#000; font-weight:bold;">TH·ª∞C THI</button>
                <button onclick="document.getElementById('modalKey').style.display='flex'" style="background:#333; color:#fff; font-size:10px;">üì¶ NH·∫¨P KHO</button>
            </div>
            
            <button onclick="logout()" style="color:red; background:none; border:1px solid red; margin-top:20px;">ƒêƒÇNG XU·∫§T</button>
        </div>

        <div class="container">
            <div class="intro-box">
                <h3>üíé ADMIN: Ho√†ng Vinh</h3>
                <p>Zalo: 0975651390 | Robot h·ªó tr·ª£ 24/7</p>
            </div>
            <div class="shop-grid" id="shopGrid"></div>
        </div>
    </div>

    <div id="modalHistory" class="modal"><div class="modal-content">
        <h3>üìä L·ªäCH S·ª¨</h3>
        <div id="histList" style="max-height: 300px; overflow-y: auto;"></div>
        <button class="btn-buy" style="background:#333" onclick="document.getElementById('modalHistory').style.display='none'">ƒê√ìNG</button>
    </div></div>

    <div id="modalKey" class="modal"><div class="modal-content">
        <h3>üì¶ NH·∫¨P KHO</h3>
        <select id="kProd"><option value="itachi">Itachi Ping V3</option><option value="hopper">Hopper Plus</option></select>
        <select id="kTime"><option>1 Ng√†y</option><option>7 Ng√†y</option><option>30 Ng√†y</option><option>Vƒ©nh Vi·ªÖn</option></select>
        <textarea id="kInput" rows="5" placeholder="M·ªói d√≤ng 1 m√£..."></textarea>
        <button class="btn-buy" onclick="saveKeys()">L∆ØU KHO</button>
        <button onclick="document.getElementById('modalKey').style.display='none'">H·ª¶Y</button>
    </div></div>

    <div id="overlay" onclick="closeMenu()" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1500;"></div>

    <script>
        const DB_KEY = 'VINH_FINAL_V50';
        const SS_KEY = 'VINH_SESSION_V50';

        let db = JSON.parse(localStorage.getItem(DB_KEY)) || {
            users: { "vinhmoddz": { pass: "vinhmoddz", bal: 10000000, admin: true, buys: [], cards: [] } },
            prods: [
                { id: 0, slug: "itachi", name: "Itachi Ping V3", plans: { "1 Ng√†y": 10000, "7 Ng√†y": 50000, "30 Ng√†y": 150000, "Vƒ©nh Vi·ªÖn": 500000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } },
                { id: 1, slug: "hopper", name: "Hopper Plus", plans: { "1 Ng√†y": 15000, "7 Ng√†y": 70000, "30 Ng√†y": 200000, "Vƒ©nh Vi·ªÖn": 700000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } }
            ]
        };

        let curU = localStorage.getItem(SS_KEY) || null;
        function save() { localStorage.setItem(DB_KEY, JSON.stringify(db)); render(); }

        function doLogin() {
            let u = document.getElementById('uLog').value.trim(), p = document.getElementById('pLog').value.trim();
            if(db.users[u] && db.users[u].pass === p) { curU = u; localStorage.setItem(SS_KEY, u); startApp(); }
            else alert("Sai th√¥ng tin s·∫øp ∆°i!");
        }

        function startApp() {
            document.getElementById('authScreen').style.display='none';
            document.getElementById('app').style.display='block';
            document.getElementById('uNameDisp').innerText = curU;
            document.getElementById('adminPanel').style.display = db.users[curU].admin ? 'block' : 'none';
            render();
        }

        function render() {
            if(!curU) return;
            document.getElementById('uBal').innerText = db.users[curU].bal.toLocaleString();
            let g = document.getElementById('shopGrid'); g.innerHTML = "";
            db.prods.forEach(p => {
                let sInfo = Object.keys(p.stock).map(k => `${k}: ${p.stock[k].length}`).join(' | ');
                g.innerHTML += `<div class="product-card">
                    <div class="stock-info">üì¶ T·ªìn kho:<br>${sInfo}</div>
                    <h2>${p.name}</h2>
                    <select id="p-${p.id}">${Object.keys(p.plans).map(k=>`<option value="${k}">${k} - ${p.plans[k].toLocaleString()}ƒë</option>`).join('')}</select>
                    <button class="btn-buy" onclick="buyItem(${p.id})">MUA NGAY</button>
                </div>`;
            });
        }

        function buyItem(id) {
            let p = db.prods[id], plan = document.getElementById(`p-${id}`).value, cost = p.plans[plan];
            if(db.users[curU].bal < cost) return alert("H·∫øt ti·ªÅn n·∫°p th√™m s·∫øp ∆°i!");
            if(p.stock[plan].length === 0) return alert("G√≥i n√†y ƒëang h·∫øt h√†ng!");
            let key = p.stock[plan].shift();
            db.users[curU].bal -= cost;
            db.users[curU].buys.unshift({ name: p.name, plan: plan, key: key, time: new Date().toLocaleString() });
            save(); alert("XONG! Key: " + key);
        }

        // --- ROBOT COMMANDS LOGIC ---
        function executeRobot() {
            let cmd = document.getElementById('robotCmd').value.trim(), p = cmd.split(" ");
            let log = document.getElementById('robotLogs');

            if(p[0] === ".chuyentien" && p[3] === "chuyen") {
                let u = p[1], v = parseInt(p[2]);
                if(db.users[u]) {
                    db.users[u].bal += v;
                    db.users[u].cards.unshift({ t: 'Robot', v: v, pin: 'N·∫†P TI·ªÄN', st: 'Th√†nh c√¥ng', time: new Date().toLocaleString() });
                    log.innerHTML = `‚úÖ ƒê√£ chuy·ªÉn ${v}ƒë cho ${u}`;
                    save();
                } else log.innerHTML = `‚ùå Kh√¥ng t√¨m th·∫•y s·∫øp ${u}`;
            } 
            else if(p[0] === ".trutien" && p[3] === "tru") {
                let u = p[1], v = parseInt(p[2]);
                if(db.users[u]) {
                    db.users[u].bal -= v;
                    log.innerHTML = `‚úÖ ƒê√£ tr·ª´ ${v}ƒë t·ª´ ${u}`;
                    save();
                }
            }
            else if(p[0] === ".checkthe") {
                let list = "";
                Object.keys(db.users).forEach(u => {
                    db.users[u].cards.forEach(c => { if(c.st === 'Ch·ªù duy·ªát') list += `${u}: ${c.v}ƒë (PIN: ${c.pin})<br>`; });
                });
                log.innerHTML = list || "üì≠ Kh√¥ng c√≥ th·∫ª n√†o ch·ªù duy·ªát.";
            }
            else if(p[0] === ".duyet" && p[3] === "thanhcong") {
                let u = p[1], pin = p[2], found = false;
                if(db.users[u]) {
                    db.users[u].cards.forEach(c => {
                        if(c.pin === pin) { c.st = 'Th√†nh c√¥ng'; found = true; db.users[u].bal += parseInt(c.v); }
                    });
                    if(found) { log.innerHTML = `‚úÖ ƒê√£ duy·ªát th·∫ª ${pin} cho ${u}`; save(); }
                }
            }
            else if(p[0] === ".xoakho") {
                let slug = p[1], prod = db.prods.find(x => x.slug === slug);
                if(prod) { 
                    Object.keys(prod.stock).forEach(k => prod.stock[k] = []); 
                    log.innerHTML = `‚úÖ ƒê√£ d·ªçn s·∫°ch kho ${slug}`; save(); 
                }
            }
            else { log.innerHTML = "‚ùå L·ªánh kh√¥ng ƒë√∫ng s·∫øp ∆°i!"; }
            document.getElementById('robotCmd').value = "";
        }

        function saveKeys() {
            let slug = document.getElementById('kProd').value, time = document.getElementById('kTime').value, raw = document.getElementById('kInput').value.trim();
            let prod = db.prods.find(x => x.slug === slug);
            if(raw) {
                prod.stock[time].push(...raw.split('\n').filter(k => k.trim() !== ""));
                save(); document.getElementById('modalKey').style.display='none';
            }
        }

        function showHistory() {
            document.getElementById('modalHistory').style.display='flex';
            let l = document.getElementById('histList'); l.innerHTML = "";
            db.users[curU].buys.forEach(b => { l.innerHTML += `<div class="hist-item"><b>${b.name}</b> (${b.plan})<br>KEY: ${b.key}</div>`; });
        }

        function openMenu() { document.getElementById('sideMenu').style.left = '0'; document.getElementById('overlay').style.display = 'block'; }
        function closeMenu() { document.getElementById('sideMenu').style.left = '-450px'; document.getElementById('overlay').style.display = 'none'; }
        function logout() { localStorage.removeItem(SS_KEY); location.reload(); }
        if(curU) startApp();
    </script>
</body>
</html>
